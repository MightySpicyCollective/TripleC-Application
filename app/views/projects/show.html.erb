<%= stylesheet_link_tag 'project' %>
<%= stylesheet_link_tag 'classroom' %>

<% @project = ProjectPresenter.new(@project) %>

<div class="container border-top-dotted class-name padding-bottom-30">
  <div class="row">
    <div class="col-lg-12 padding-top-50 padding-left-0 padding-right-0">
      <div class="col-md-8 padding-left-0 padding-right-0">
        <div class="col-md-4 padding-left-0 padding-right-0">
          <%= image_tag @project.school.photo.url(:medium), class: 'img-responsive center-block' %>
        </div>
        <div class="col-md-8">
          <div class="col-md-12">
            <h1><%= @project.name %></h1>
            <div class="project-finish-by">by
              <%= link_to @project.classroom.name, classroom_path(@project.classroom) %>
            </div>
            <p><%= @project.description %></p>
            <% if current_user %>
              <div>
                <%= link_to 'Edit Project Details', edit_user_project_path(current_user, @project), class: 'edit-class-profile' %>
              </div>
            <% end %>
          </div>
          <div class="col-md-12 padding-top-30 padding-bottom-30">
            <div class="col-md-5 padding-left-0">
              <a href="#" title="Edit in place" class="btn btn-primary width-full">Edit in place</a>
            </div>
            <div class="col-md-7 padding-left-0">
              <a href="#" title="Use and Edit in Sonic-pi" class="btn btn-primary width-full">Use and Edit in Sonic-pi</a>
            </div>
          </div>
          <div class="clearfix"> </div>
        </div>
      </div>
      <div class="col-lg-1">&nbsp;</div>
      <div class="col-md-3 padding-left-0 padding-right-0 classroom-right-col">
        <div class="col-md-12">
          <div class="col-md-12 padding-bottom-30">
            <div class="heading">School</div>
            <%= link_to @project.school.name, school_path(@project.school), class: 'scrap-links'%>
          </div>
          <div class="col-md-12 padding-bottom-30">
            <div class="heading">City</div>
            <%= link_to @project.school.location, '#', class: 'scrap-links' %>
          </div>
          <% if @project.teacher %>
            <div class="col-md-12 padding-bottom-30">
              <div class="heading">Teacher</div>
              <%= link_to @project.teacher.name, user_path(@project.teacher), class: 'scrap-links' %>
            </div>
          <% end %>
        </div>
      </div>
    </div>
  </div>
</div>

<div class="container">
  <div class="row">
    <div class="col-md-12 border-top-dotted padding-top-30 padding-bottom-30 padding-left-0 padding-right-0">
    <div class="row">
      <div class="col-md-9 latest-enteries">
        <div class="col-md-12 heading">
          <div class="col-md-12 padding-left-0">Latest</div>
        </div>
        <div class="col-md-12 padding-left-0 padding-right-0 entry-content content_highlight">
          <div class="content_highlight-show">
            <pre><code><%= @project.source_code %></code></pre>
          </div>
        </div>
      </div>
      <div class="col-md-3 padding-left-0 padding-right-0 right-col-follow-section">
        <div class="col-md-12 padding-bottom-30">
          <h3>Previous Entries</h3>
          <ul>
            <% @versions.each_with_index do |version, index| %>
              <li>
                <div class="col-md-3 col-sm-3 col-xs-3 padding-left-0 padding-right-0">
                  <%= image_tag performer_user(version).avatar.url(:thumb), class: "img-responsive"  %>
                </div>
                <div class="col-md-9 col-sm-9 col-xs-9">
                  <div><%= link_to change_performer(version), history_project_path(@project, page: index + 1), class: 'scrap-links' %></div>
                  <div class="date-entry">12th Dec, 2015</div>
                </div>
                <div class="clearfix"> </div>
              </li>
            <% end %>
          </ul>
        </div>
      </div>
    </div>
  </div>
</div>

<script type="text/javascript">
  (function() {
    var pre = document.getElementsByTagName('pre'),
      pl = pre.length;
      for (var i = 0; i < pl; i++) {
        pre[i].innerHTML = '<span class="line-number"></span>' + pre[i].innerHTML + '<span class="cl"></span>';
        var num = pre[i].innerHTML.split(/\n/).length;
        for (var j = 0; j < num; j++) {
          var line_num = pre[i].getElementsByTagName('span')[0];
          line_num.innerHTML += '<span>' + (j + 1) + '</span>';
        }
      }
  })();
</script>
